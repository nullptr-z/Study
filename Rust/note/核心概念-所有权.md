# Rust 为什么优秀

1. 它融合了很多语言的优秀特性，都是一些语言中经过实践的优秀特性，例如 Rc
2. 在像 C/C++这类开放语言中的优秀编码规范，本来有些编写规范需要程序员去遵守，Rust 通过编译器，提醒或者说强制你这么去做;，例如 RAII
3. 在所有权和生命周期的规则下 RAII 模式是自然发生的

## Drop

当变量离开作用域，Rust 为我们调用一个特殊的函数。这个函数叫做 drop ，在这里
String 的作者可以放置释放内存的代码。Rust 在结尾的 } 处自动调用 drop
--有点像析构函数

## Copy and Move

Rust 永远也不会自动创建数据的 “深拷贝”。因此，任何自动的复制可以被认为对运行时性能影响较小

Copy 语义: 只有存在栈里的结构才可以实现 Copy Trait

一个类型实现了 Copy Trait，那么赋值或传参会使用 Copy，相应的值会被按位拷贝（浅拷贝）

PS：大多数情况不建议实现 Copy 的, 因为一个结构很容易变得不可 Copy，例如增加一个 String 的字段,
而且 Copy Trait 会覆盖 Rust `移动语义`，这会让结构的使用者感到意外 Surprise, 所以建议实现 Clone

## 移动语义

Rust 中非数值类型，大多是类型都是默认移动所有权的，也就是在把一个对象的实例，赋值给另一个变量的时候，旧的变量就不能再使用了

自定义结构通过 Copy Trait 来覆盖这种行为

# 重要概念

- 在 Rust 编程语言中，引用和借用是非常重要的概念，它们用于管理内存和避免数据竞争。
- 同时引用和借用系统是其内存安全和线程安全的核心，它们确保程序不会出现常见的内存错误，如空指针引用、悬垂指针和数据竞争。

引用和借用的概念很模糊，似乎引用代表的是 & 符号，借用是基于引用的规则。

## 引用 References

引用是指在不转移所有权的情况下，通过指向数据的指针来访问数据。Rust 中的引用使用“&”符号表示。例如，如果要引用一个名为“x”的变量，可以使用“&x | &mut x”来创建一个指向该变量的引用。引用的重要性在于它们允许多个代码块同时访问同一数据，而无需在多个位置拷贝数据。

## 借用 Borrowing

借用是 Rust 中一种使用引用来访问和操作数据的概念。当我们将引用作为函数参数传递时，实际上是在借用数据, 或者说在另一个域引用当前域的变量就是借用。借用有助于避免不必要的数据复制和确保内存安全。
注意，根据 Rust 的借用规则，以下情况不能同时发生：

> 一个变量只能有一个可变引用，或多个不可变引用；防止数据竞争

---

在 Rust 中，“引用”和“借用”是不同的概念，但是它们经常一起使用。

引用是 Rust 中的一个类型，它是通过 & 符号创建的，表示对某个值的“引用”（或者说“指向”）。在这种情况下，“引用”指的是一个指针，它指向存储在内存中的某个值的位置，而不是该值本身。引用有两种类型：不可变引用（&T）和可变引用（&mut T），用于表示对值的只读访问和可读写访问。

借用是一种操作，它允许我们通过创建引用来暂时地“借用”某个值的所有权。在这种情况下，“借用”指的是我们暂时获得了对某个值的所有权，但在借用期间，原始所有者仍然是该值的唯一所有者。当借用期结束时，我们必须将所有权还给原始所有者。在 Rust 中，借用是通过在函数参数中使用引用来实现的。

因此，可以说引用是一种类型，而借用是一种操作。借用通常需要引用来实现，但不是所有引用都是借用。
